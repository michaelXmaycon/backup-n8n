{"createdAt":"2025-05-25T14:58:41.585Z","updatedAt":"2025-07-21T12:14:29.000Z","id":"jVmWv6hzPhynKDxX","name":"Miniatures Virals","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-520,4040],"id":"f042704f-fb25-44aa-9d4a-e4ee1299f071","name":"When clicking ‘Test workflow’"},{"parameters":{"model":"openai/gpt-4.1-mini","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[700,3060],"id":"1e23387d-de2e-4ccd-a658-1cb9e4323aab","name":"OpenRouter Chat Model1"},{"parameters":{"model":"openai/gpt-4.1-mini","options":{"temperature":0.9}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1080,3060],"id":"c4db76a1-565d-4294-b282-0b6aac068699","name":"OpenRouter Chat Model"},{"parameters":{"jsonSchemaExample":"{\n  \"process\": \"process\",\n  \"steps\": [{\n    \"number\": 1,\n    \"rawDescription\": \"\",\n    \"textToImagePrompt\": \"\",\n    \"animationPrompt\": \"\",\n    \"soundEffectPrompt\": \"\"\n  }, {}],\n  \"backgroundMusicPrompt\": \"\"\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[1260,3060],"id":"ef6ee943-500b-4dbb-8b91-3f4f134f2ad7","name":"Structured Output Parser2"},{"parameters":{"promptType":"define","text":"=Process:\n{{ $json.output.process }}\n\nSteps:\n{{ $json.output.steps.toJsonString() }}","hasOutputParser":true,"options":{"systemMessage":"=### #Role  \nYou are a creative director for a TikTok account featuring AI-generated videos of tiny workers in whimsical miniature worlds. The videos you create show a process those workers do from start to finish.\n\nYou will be given the process name and raw description of each step in the process performed by these tiny human workers.\n\n---\n\n### #Task  \nYour task is to analyze each scene in the context of the whole process, craft a detailed text to image prompt for our visualization team for each step based on that information, and also craft a short prompt for animation and sound effect for that scene. Each scene will last only 5 seconds. The context is a highly detailed miniature setting where tiny human workers use tools and props to complete their tasks.\n\n---\n\n### #Instructions  \nFor each step:  \n1. Write a concise yet vivid image description that captures the scene, including the tiny human workers’ actions, the miniature environment, and any quirky or charming details; describe light, viewpoint, main objects on a scene and scene details. Ensure the description is specific enough for an AI image generator to produce a clear, engaging visual that fits a short TikTok clip. Make sure to emphasize the oversized giant objects and miniature size of the figures in each prompt.  \n2. For animation prompt use a minimal explanation of what is happening in the scene.  \n3. For Sound effect prompt focus on sounds in that environment. It should be concise.\n\n**Note:** each text to image prompt will be used independently of previous images or prompts, so you are not allowed to point to objects from previous prompts or scenes. When you need to do that, just repeat the details (environment, clothes, props) instead of pointing to the objects.  \nSound effect prompt will be used on its own, don’t point to objects from a scene in it. It should be independent.  \nAnimation will be done using image to video, so you need to mention same objects as you mentioned in the image.\n\n---\n\n### #Output  \n**Output result as json:**\n\n{\n  \"process\": \"process\",\n  \"steps\": [{\n    \"number\": 1,\n    \"rawDescription\": \"\",\n    \"textToImagePrompt\": \"\",\n    \"animationPrompt\": \"\",\n    \"soundEffectPrompt\": \"\"\n  }, {}],\n  \"backgroundMusicPrompt\": \"\" //prompt for instrumental background music for the whole video. Should match the style, pace, theme, mood of the process. Should be classical and cinematic. Below 200 chars here please.\n}\n\n\n---\n\n### #Example  \n**Example `textToImagePrompt`:**  \nIn this *whimsical depiction*, a large white sneaker serves as the focal point, embellished with a fabric golden star. Miniature figures, dressed in quaint work attire, are seen creating and maintaining the shoe, emphasizing the concept of craftsmanship. The composition is warm and inviting, with soft, ambient lighting that highlights the textures of the materials surrounding the shoe. The overall mood evokes a sense of creativity and artisanal charm. The shot is a shot from the top as a miniature panorama scene.\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[1100,2840],"id":"4a4b5387-d14d-40d4-9dd7-c9bee88e5fe4","name":"Create Scenes"},{"parameters":{"batchSize":5,"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[960,4160],"id":"b68780fc-a6a7-4968-9502-6c56379ab524","name":"Loop Over Items"},{"parameters":{"method":"POST","url":"https://api.freepik.com/v1/ai/mystic","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"prompt\": {{ JSON.stringify($json[\"Image Prompt\"]) }},\n  \"style_reference\": \"{{ $('Convert to Base64 String').item.json.base64_String }}\",\n  \"adherence\": 50,\n  \"hdr\": 60,\n  \"resolution\": \"1k\",\n  \"aspect_ratio\": \"social_story_9_16\",\n  \"model\": \"realism\",\n  \"creative_detailing\": 60,\n  \"engine\": \"magnific_sharpy\",\n  \"fixed_generation\": false,\n  \"filter_nsfw\": false\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1180,4080],"id":"a9738e8c-fc96-4b51-ab17-15e6afb89aa1","name":"Send Request","credentials":{"httpHeaderAuth":{"id":"YLIJzXvBZurBhNCd","name":"Together.ai"}}},{"parameters":{"url":"=https://api.freepik.com/v1/ai/mystic/{{ $json.data.task_id }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1620,4000],"id":"e952b760-e990-47c7-b3ce-6acc87647e92","name":"Check Request"},{"parameters":{"amount":20},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1400,4080],"id":"70aacd94-db74-4e8e-ad60-7252294fd1aa","name":"Wait","webhookId":"cc23db54-fce3-4789-a6bd-afda8545c632"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"bdb4c198-4df9-41ba-8b83-36c416b62e38","leftValue":"={{ $input.all().filter(item => item.json.data.status == \"IN_PROGRESS\").length }}\n","rightValue":0,"operator":{"type":"number","operation":"equals"}},{"id":"b9ef78f1-336b-4546-a827-2667842aa1e9","leftValue":"={{ $runIndex }}","rightValue":50,"operator":{"type":"number","operation":"gt"}}],"combinator":"or"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1840,4080],"id":"ff0d15da-90ab-4a1e-a8d8-2d0732f690ec","name":"Is Completed"},{"parameters":{"aggregate":"aggregateAllItemData","include":"specifiedFields","fieldsToInclude":"Process Idea","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[3280,4000],"id":"0329720e-5a5e-4ed8-a349-76f7d2f36543","name":"Aggregate"},{"parameters":{"jsonSchemaExample":"{\n  \"process_ideas\": [\n    \"Weaving grass hammocks between bonsai trees\",\n    \"Frosting miniature cupcakes with flower-petal icing\",\n    \"Filling sand timers with stardust grains\",\n    \"Polishing beetle shells for royal insect parades\",\n    \"Stacking and organizing leaf-cut paper files\",\n    \"Charging glowberries with tiny lightning rods\",\n    \"Binding dream journals using spider-silk thread\",\n    \"Repainting street signs in a snail-sized village\",\n    \"Carving furniture from sugar cubes\",\n    \"Harvesting dewdrops from velvet moss\"\n  ]\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[3700,4120],"id":"a0be0e63-e9cb-49e9-91c3-5a121cf059e3","name":"Structured Output Parser"},{"parameters":{"fieldToSplitOut":"output.process_ideas","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[3880,4000],"id":"61d83437-ed0e-499d-8d35-f2fe6d3fa641","name":"Split Out1"},{"parameters":{"model":"openai/gpt-4.1-mini","options":{"temperature":0.6}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[3480,4120],"id":"b617c567-1a54-4745-a1ef-aa846f657077","name":"OpenRouter Chat Model3"},{"parameters":{"aggregate":"aggregateAllItemData","destinationFieldName":"AudioTracks","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[960,3700],"id":"aec9a708-d1e5-4b50-83f8-fc94657582e5","name":"Aggregate1"},{"parameters":{"assignments":{"assignments":[{"id":"40f3446b-5b76-4f5a-8706-1be04af684dd","name":"id","value":"={{ $json.id }}","type":"number"},{"id":"fa4d5917-f4de-4d5a-bc2b-a95cae944d2a","name":"Description","value":"={{ $json.Description }}","type":"string"},{"id":"2b04b258-6fb4-42b5-8726-fb73c31950bc","name":"AudioTrackURL","value":"={{ $json['Audio File'][0].url }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[740,3700],"id":"9b976a32-5246-48ba-907f-f62a1d3f5d65","name":"Edit Fields"},{"parameters":{"jsonSchemaExample":"{\n  \"Process ID\": \"id from the process list\",\n  \"process\": \"randomly chosen process from list\",\n  \"steps\": [\n    {\n      \"number\": 1,\n      \"rawDescription\": \"\"\n    },\n    {\n      \"number\": 2,\n      \"rawDescription\": \"\"\n    }\n  ]\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[900,3060],"id":"a70239ea-e003-4dbb-a883-437820c9a646","name":"Structured Output Parser1"},{"parameters":{"assignments":{"assignments":[{"id":"fadd6161-93a2-4e60-9ef8-da47ecb7f7ab","name":"scenes","value":"={{ $('Create Scenes').item.json.output.steps }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1920,2840],"id":"8468ea19-6168-498c-9e7a-0557766eb5f1","name":"Set Scenes"},{"parameters":{"operation":"create","databaseId":191,"tableId":735,"fieldsUi":{"fieldValues":[{"fieldId":7173,"fieldValue":"={{ $('Create Scenes').item.json.output.process }}"},{"fieldId":7189,"fieldValue":"={{ $('Create Scenes').item.json.output.backgroundMusicPrompt }}"},{"fieldId":7191,"fieldValue":"Processing"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1700,2840],"id":"9de9babb-018d-475b-8346-fbb21e9d9217","name":"Create Video Record"},{"parameters":{"fieldToSplitOut":"scenes","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[2140,2840],"id":"bcee138e-df53-418e-87df-c4e946305f35","name":"Split Out Scenes"},{"parameters":{"promptType":"define","text":"=Music: {{ $('Get Video').item.json['Background Music Prompt'] }}\nProcess: {{ $('Get Video').item.json.Process }}","hasOutputParser":true,"options":{"systemMessage":"=You are a creative director for a TikTok account featuring AI-generated videos of tiny workers in whimsical miniature worlds.\n\nYou will be given a description of a music we want to have in a video and your task is to pick one and only one music track from our music library that matches the best, and return it.\n\n**##Music Library**  \n`{{ $json.AudioTracks.toJsonString() }}`\n\n**#Return Format**  \nReturn matching track in json format:\n\n{\n  \"id\": 1,\n  \"musicurl\": \"url\"\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[1380,3620],"id":"f9642f8a-af14-45a0-8ddf-634df31da934","name":"Music Picker"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,3700],"id":"e88efe65-949a-4bd0-a366-b6b4c4ea3e45","name":"Get Video"},{"parameters":{"databaseId":191,"tableId":737,"returnAll":true,"additionalOptions":{}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[520,3700],"id":"0e1ed4a2-d3e4-4527-b042-712be1b1174d","name":"Get Music"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1300,3820],"id":"1442bffa-cd34-405e-8cef-63f677f6800d","name":"OpenRouter Chat Model4"},{"parameters":{"jsonSchemaExample":"{\n  \"id\": 1,\n  \"musicurl\": \"url\"\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[1600,3820],"id":"790a68b6-182e-412b-9151-3bb0618cd427","name":"Structured Output Parser3"},{"parameters":{"method":"POST","url":"http://host.docker.internal:85/api/user-files/upload-file/","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2280,4080],"id":"928c282d-fc5a-46cb-956c-62891cfa4706","name":"Upload to baserow"},{"parameters":{"url":"={{ $json.data.generated[0] }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2060,4080],"id":"cbf89cdd-2bde-41f4-9c92-872098b99b63","name":"Download Image"},{"parameters":{"batchSize":5,"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[960,4520],"id":"23a9ff01-d141-42dc-b855-2fdc7d320db3","name":"Loop Over Items1"},{"parameters":{"amount":20},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1400,4460],"id":"bef5e5e4-0216-4a1b-ad95-13618b185532","name":"Wait1","webhookId":"6d55d750-b380-45dd-a322-026ba020358d"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"bdb4c198-4df9-41ba-8b83-36c416b62e38","leftValue":"={{ $input.all().filter(item => item.json.status === \"IN_PROGRESS\" || item.json.status === \"IN_QUEUE\").length }}","rightValue":0,"operator":{"type":"number","operation":"equals"}},{"id":"b9ef78f1-336b-4546-a827-2667842aa1e9","leftValue":"={{ $runIndex }}","rightValue":50,"operator":{"type":"number","operation":"gt"}}],"combinator":"or"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1840,4460],"id":"ef47274d-d22b-473c-bb7e-80313a513c6e","name":"Is Completed1"},{"parameters":{"method":"POST","url":"http://host.docker.internal:85/api/user-files/upload-file/","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2500,4460],"id":"82a5f6d0-6c31-48b1-ad44-458a29d2bf5b","name":"Upload to baserow1"},{"parameters":{"method":"POST","url":"http://host.docker.internal:8080/v1/video/concatenate","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"video_urls\": {{ JSON.stringify($json.video_urls) }},\n    \"id\": \"{{ $('Get video').item.json.id }}\"\n}","options":{"timeout":50000}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1380,5160],"id":"632109c1-4c61-4f04-ab10-1bd17a7b2794","name":"Combine Clips"},{"parameters":{"content":"## Section 7 - Combine clips into 1 video","height":300,"width":1680,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,5060],"id":"abaf4ad3-91a1-410a-a3b6-91bde6ee4f59","name":"Sticky Note3"},{"parameters":{"jsCode":"// Extract the array of URLs\nconst urls = $input.first().json.url || [];\n\n// Map URLs into the required structure\nconst formattedURLs = urls.map(url => ({ \"video_url\": url }));\n\n// Return the transformed data\nreturn [{\n    json: {\n        \"video_urls\": formattedURLs\n    }\n}];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1160,5160],"id":"53546906-50b3-4e77-859a-9c50986c003b","name":"Video url to array"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[280,5160],"id":"32325e94-c40b-4c26-ab4f-caa6d3a4521c","name":"Get video"},{"parameters":{"databaseId":191,"tableId":736,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7187,"value":"={{ $json.id }}"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[720,5160],"id":"b754f2ed-2160-4acb-beb0-b6acd9018578","name":"Get Scenes"},{"parameters":{"fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"Video Clip URL"},{"fieldToAggregate":"['Video + SoundFX'][0].url"}]},"options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[940,5160],"id":"508323f5-5635-461d-8715-36cfc3d7f106","name":"Aggregate2"},{"parameters":{"method":"POST","url":"http://host.docker.internal:8080/v1/ffmpeg/compose","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"id\": \"audio-layering-over-original\",\n  \"inputs\": [\n    {\n      \"file_url\": \"{{ $('Get Video1').item.json['Raw Video URL'] }}\"\n    },\n    {\n      \"file_url\": \"{{ $json['Audio File'][0].url }}\"\n    }\n  ],\n  \"filters\": [\n    {\n      \"filter\": \"[0:a][1:a]amix=inputs=2:duration=shortest[outa]\"\n    }\n  ],\n  \"outputs\": [\n    {\n      \"options\": [\n        {\n          \"option\": \"-map\",\n          \"argument\": \"0:v\"\n        },\n        {\n          \"option\": \"-map\",\n          \"argument\": \"[outa]\"\n        },\n        {\n          \"option\": \"-c:v\",\n          \"argument\": \"copy\"\n        },\n        {\n          \"option\": \"-c:a\",\n          \"argument\": \"aac\"\n        },\n        {\n          \"option\": \"-shortest\"\n        }\n      ]\n    }\n  ]\n}\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[720,5460],"id":"1af1be7f-55a7-4cea-86a3-c9f0c4d6ce26","name":"Add Music"},{"parameters":{"content":"## Section 8 - Add BG Music","height":300,"width":1460,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,5380],"id":"475ba0b2-a2a3-4339-9993-9dfa0af49349","name":"Sticky Note8"},{"parameters":{"operation":"update","databaseId":191,"tableId":735,"rowId":"={{ $('Get Video1').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7200,"fieldValue":"={{ $json.name }}"},{"fieldId":7191,"fieldValue":"Done"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1380,5460],"id":"0181e7a5-25c2-4ab4-b14d-62a4c040aaef","name":"Baserow17"},{"parameters":{"method":"POST","url":"http://host.docker.internal:85/api/user-files/upload-file/","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1820,4760],"id":"f90b805a-5768-44d0-8671-9c12e712688e","name":"Upload to baserow3"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[280,5460],"id":"566abfb0-48fb-4109-aaf6-a74d3f09c7a0","name":"Get Video1"},{"parameters":{"operation":"get","databaseId":191,"tableId":737,"rowId":"={{ $json.Music[0].id }}"},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[500,5460],"id":"2ef308b8-9695-406b-aa20-829abb9966ee","name":"Get Music1"},{"parameters":{"content":"## Section 6 - Add Sound FX","height":300,"width":2000,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,4740],"id":"2e98d773-3f8d-4388-b0ad-c0b6fc6faa1d","name":"Sticky Note"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[280,4840],"id":"307c7807-f933-4d80-90b5-ce38e55f8535","name":"Get video1"},{"parameters":{"databaseId":191,"tableId":736,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7187,"value":"={{ $json.id }}"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[720,4840],"id":"c159b70f-a18f-40d9-9b14-975b2db1b951","name":"Get Scenes1"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[940,4840],"id":"1db27461-981b-4335-bbd6-89c2141b6384","name":"Loop Over Items3"},{"parameters":{"method":"POST","url":"http://host.docker.internal:85/api/user-files/upload-file/","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1160,5460],"id":"78e09a67-a99f-4e32-a2f1-df999ae0414f","name":"Upload to baserow6"},{"parameters":{"url":"={{ $json.response[0].file_url }}","options":{"response":{"response":{"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[940,5460],"id":"43ccf72c-f1c2-4919-8c00-275bc10050dc","name":"HTTP Request6"},{"parameters":{"operation":"create","databaseId":191,"tableId":736,"fieldsUi":{"fieldValues":[{"fieldId":7176,"fieldValue":"={{ $json.rawDescription }}"},{"fieldId":7177,"fieldValue":"={{ $json.textToImagePrompt }}"},{"fieldId":7185,"fieldValue":"={{ $json.animationPrompt }}"},{"fieldId":7186,"fieldValue":"={{ $json.soundEffectPrompt }}"},{"fieldId":7184,"fieldValue":"={{ $('Create Video Record').item.json.id }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[2360,2840],"id":"7a097ed5-db65-41b2-9062-ced3b62a8e1e","name":"Create Scene Records"},{"parameters":{"content":"## Process Generator (10 new)\n","height":440,"width":1320,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2960,3820],"id":"cdcd5468-febc-4741-a9af-095ebd956631","name":"Sticky Note2"},{"parameters":{"databaseId":191,"tableId":734,"returnAll":true,"additionalOptions":{}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[3060,4000],"id":"a59ba9de-f908-4c76-a444-14c143035adf","name":"Get All Processes","alwaysOutputData":true,"credentials":{"baserowApi":{"id":"tYV1U8mNC5TG68rD","name":"Baserow account"}},"onError":"continueRegularOutput"},{"parameters":{"promptType":"define","text":"=Existing ideas:\n{{ JSON.stringify($json.data) }}","hasOutputParser":true,"options":{"systemMessage":"=You are a creative ideation agent tasked with generating **original and visually compelling process ideas** for use in short-form video content featuring AI-generated tiny workers in whimsical miniature worlds.\n\nYour goal is to come up with **fresh, never-before-used process ideas** that are visually dynamic, satisfying, and full of charm.\n\nEach idea should belong to or be inspired by one of the following categories:\n- Manufacturing Processes  \n- Personal Attention Roleplays  \n- Crafting and Artisanal Processes  \n- Organizational Tasks  \n- Rituals  \n- Cultivation  \n- Transformation  \n\nProcess ideas can be real, imaginary, or fairytale-inspired — as long as they are highly visual and engaging at a tiny scale. Think of what would be mesmerizing to watch in a 1-minute video.\n\n**Important Instructions:**\n- The user will provide a list of already-generated ideas.\n- Your task is to generate 10 **new** ideas only — do **not** repeat or rephrase any existing ideas.\n- Do **not** include process steps or breakdowns. Just generate concise, distinct process concepts.\n\n---\nexample outputs\n\n    \"Weaving grass hammocks between bonsai trees\",\n    \"Frosting miniature cupcakes with flower-petal icing\",\n    \"Filling sand timers with stardust grains\",\n    \"Polishing beetle shells for royal insect parades\",\n    \"Stacking and organizing leaf-cut paper files\",\n    \"Charging glowberries with tiny lightning rods\",\n    \"Binding dream journals using spider-silk thread\",\n    \"Repainting street signs in a snail-sized village\",\n    \"Carving furniture from sugar cubes\",\n    \"Harvesting dewdrops from velvet moss\"\n\n\n**Output JSON format:**\n\n{\n  \"process_ideas\": [\n    \"Weaving grass hammocks between bonsai trees\",\n    \"Frosting miniature cupcakes with flower-petal icing\",\n    \"Filling sand timers with stardust grains\",\n    \"Polishing beetle shells for royal insect parades\",\n    \"Stacking and organizing leaf-cut paper files\",\n    \"Charging glowberries with tiny lightning rods\",\n    \"Binding dream journals using spider-silk thread\",\n    \"Repainting street signs in a snail-sized village\",\n    \"Carving furniture from sugar cubes\",\n    \"Harvesting dewdrops from velvet moss\"\n  ]\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[3500,3900],"id":"cf329ff2-534e-4c7b-bdb6-bcfc9cf36664","name":"Generate"},{"parameters":{"operation":"create","databaseId":191,"tableId":734,"fieldsUi":{"fieldValues":[{"fieldId":7170,"fieldValue":"={{ $json[\"output.process_ideas\"] }}"},{"fieldId":7211,"fieldValue":"Available"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[4100,4000],"id":"70654477-b366-4257-8b1e-8782165b06a4","name":"Add New Processes"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[720,3320],"id":"e6ed1970-fb6c-4731-a1dc-30c2f61959d1","name":"Get Video2"},{"parameters":{"aggregate":"aggregateAllItemData","include":"specifiedFields","fieldsToInclude":"id, Description","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[500,3320],"id":"c1903b26-476f-473f-adfc-89fd5c5124c8","name":"Aggregate3"},{"parameters":{"promptType":"define","text":"=SoundFX library:\n{{ $('Aggregate3').item.json.data.toJsonString() }}\n\nSound Prompt:\n{{ $json['Sound Effect Prompt'] }}","hasOutputParser":true,"options":{"systemMessage":"=You are an AI agent tasked with selecting the most appropriate SoundFX from a provided SoundFX library based on a given Sound Prompt.\n\nThe SoundFX library is provided as a list of JSON objects in the following format:\n\n\n{\n  \"id\": 21,\n  \"Description\": \"string\"\n}\n\n\nYour goal is to choose the single SoundFX entry that best matches the meaning or intent of the Sound Prompt.  \n**Do not** generate new SoundFX, modify existing entries, or alter the Sound Prompt in any way.  \nSimply return the `id` of the best-matching SoundFX from the library.\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[1380,3240],"id":"f72fb644-0cea-4480-9847-e2819ffdaed8","name":"SoundFX Picker"},{"parameters":{"operation":"get","databaseId":191,"tableId":736,"rowId":"={{ $json.id }}"},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1160,3320],"id":"36ace66f-9872-43d0-8f99-655df6be1dc9","name":"Get Scenes2"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1340,3440],"id":"12acbb0c-fb7d-4b5b-a31f-924b7e2d537d","name":"OpenRouter Chat Model2"},{"parameters":{"jsonSchemaExample":"{\n\"id\": 21,\n\"Orginal Sound Prompt\": \"Orginal Sound Prompt\",\n\"Description\": \"string\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[1600,3440],"id":"69efeb2a-e4cf-4559-8bca-8c5ca72ffb91","name":"Structured Output Parser4"},{"parameters":{"content":"## Section 5 - Generate Videos","height":360,"width":2700,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,4360],"id":"ec99179c-a663-4449-908e-0a319930b85d","name":"Sticky Note1"},{"parameters":{"content":"## Section 4 - Generate Scene Images","height":360,"width":2700,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,3980],"id":"a38e3623-b4a1-4b61-baf7-a2cc9fe56327","name":"Sticky Note5"},{"parameters":{"content":"## Section 3 - Pick Music From Library","height":360,"width":1780,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,3600],"id":"771f4e0d-cee2-4b0d-bae1-1df4d3f89168","name":"Sticky Note6"},{"parameters":{"content":"## Section 2 -  Pick SoundFX from library","height":360,"width":1780,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,3220],"id":"4e1878d7-ba16-4a73-b51e-1bf23e555ce4","name":"Sticky Note7"},{"parameters":{"aggregate":"aggregateAllItemData","include":"specifiedFields","fieldsToInclude":"id, Process Idea","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[520,2840],"id":"60465c68-955c-4351-bcd5-d334dccb7603","name":"Aggregate4"},{"parameters":{"databaseId":170,"tableId":693,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":6707,"operator":"contains","value":"Available"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,2840],"id":"3d3ab9c1-c251-48e5-8980-40ec9189e56f","name":"Get Process Ideas","credentials":{"baserowApi":{"id":"tYV1U8mNC5TG68rD","name":"Baserow account"}}},{"parameters":{"operation":"update","databaseId":191,"tableId":734,"rowId":"={{ $('Process Picker/Generator').item.json.output['Process ID'] }}","fieldsUi":{"fieldValues":[{"fieldId":7211,"fieldValue":"Used"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1480,2840],"id":"74419dc4-8bf5-42be-bdcc-0e827b1d6172","name":"Mark Process Used"},{"parameters":{"content":"# Section 1 - Pick process and scenes","height":460,"width":2300,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,2740],"id":"b63e4403-45a9-4797-82fa-0fb45f71a7bd","name":"Sticky Note9"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,4160],"id":"039f28b9-0c47-4ca5-8dd5-a1c2ab2130df","name":"Get Video3"},{"parameters":{"databaseId":191,"tableId":736,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7187,"value":"={{ $json.id }}"},{"field":7194,"operator":"empty"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[740,4160],"id":"78f70b23-72de-4ec4-baa9-97293133968e","name":"Get Scenes3"},{"parameters":{"operation":"get","databaseId":191,"tableId":740,"rowId":"4"},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,4020],"id":"4ad98c6b-a788-46ea-a8e9-d1ff7490c83c","name":"Get Style By ID"},{"parameters":{"url":"={{ $json['style reference'][0].url }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[520,4020],"id":"06d83284-51ad-4c52-9116-2431668bd068","name":"Download Image2"},{"parameters":{"operation":"binaryToPropery","destinationKey":"base64_String","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[740,4020],"id":"f96f80e6-6f1b-4943-b717-c43fa5adf6c1","name":"Convert to Base64 String"},{"parameters":{"resource":"video","operation":"upload","title":"={{ $('Create titles & hashtags').item.json.output.title }}, {{ $json.output.hashtags }}","regionCode":"GB","categoryId":"24","options":{"description":"={{ $('Create titles & hashtags').item.json.output.title }} {{ $json.output.hashtags }}","privacyStatus":"private","selfDeclaredMadeForKids":false}},"type":"n8n-nodes-base.youTube","typeVersion":1,"position":[1120,5760],"id":"81f859ea-7ac0-4441-9e76-4370c28e6103","name":"YouTube","credentials":{"youTubeOAuth2Api":{"id":"gyb44TbxD62kwqO8","name":"YouTube account"}}},{"parameters":{"model":"openai/gpt-4.1-mini","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[500,5920],"id":"18707734-04c9-49da-ac2e-8b338c6b8092","name":"OpenRouter Chat Model6","credentials":{"openRouterApi":{"id":"QdnxsfiR3etVIUeV","name":"OpenRouter account"}}},{"parameters":{"jsonSchemaExample":"{\n  \"title\": \"string\",\n  \"hashtags\": \"string\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[720,5920],"id":"0a10dc7c-8a21-4355-94ab-419e7866e8bb","name":"Structured Output Parser6"},{"parameters":{"promptType":"define","text":"=Process: {{ $json.Process }}","hasOutputParser":true,"options":{"systemMessage":"=You are a creative AI assistant that specializes in crafting viral YouTube Shorts titles and hashtags. You are given a short, whimsical description of a process done by tiny, cute workers (e.g., fairies, mini creatures, toy-like beings). Your job is to generate:\n\n1. A catchy and curiosity-inducing **title** that would make viewers want to click.\n2. A set of **2 to 3 relevant and popular hashtags**, optimized for virality in the \"cute\", \"miniature\", and \"oddly satisfying\" niches.\n\n📝 Your output must follow this **JSON format**:\n\n```json\n{\n  \"title\": \"string\",\n  \"hashtags\": \"string\"\n}\n```\n\n🎯 The **combined length of the title and hashtags must not exceed 80 characters**.\nMake the title playful, emotional, or intriguing. Hashtags should be space-separated and each start with `#`."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[520,5760],"id":"39690e00-f813-4cb7-ba13-de02ac0144ba","name":"Create titles & hashtags"},{"parameters":{"url":"={{ $('Get Last video').item.json['Final Video'][0].url }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[900,5760],"id":"3b3fb230-cdd5-4c4e-84be-aa56669f88b8","name":"Download video"},{"parameters":{"content":"## Generate title & hashtag, Upload to YouTube","height":360,"width":1220,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[240,5700],"id":"2527a418-affe-4b31-818a-8a154b481596","name":"Sticky Note10"},{"parameters":{"databaseId":191,"tableId":735,"limit":1,"additionalOptions":{"order":{"fields":[{"field":7253,"direction":"-"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,5760],"id":"df03db4b-71a7-4e07-a671-3f0d1e675e0d","name":"Get Last video","credentials":{"baserowApi":{"id":"tYV1U8mNC5TG68rD","name":"Baserow account"}}},{"parameters":{"promptType":"define","text":"=Use a process from the following list:\n{{ $json.data.toJsonString() }}","hasOutputParser":true,"options":{"systemMessage":"=You are a creative director for a TikTok account featuring AI-generated videos of tiny workers in miniature worlds.\n\nYour task is to pick one deeply satisfying process from the **provided list** that will captivate viewers in a 1-minute video made up of short, mesmerizing clips.\n\nThe list contains processes from categories such as: Manufacturing Processes, Personal Attention Roleplays, Crafting and Artisanal Processes, Organizational Tasks, Ritual, Cultivation, or Transformation Processes. They may be real or inspired by fairytales.  \nYour job is to **select one process** from this list that would be visually dynamic, whimsical, and suited to a shifting, fantastical realm.\n\nThen, provide a detailed list of 6–8 raw steps that break down that process from start to finish.\n\nEach step should be concise, represent a clear progression, and highlight the charm of tiny human workers (about 2–3 inches tall) using tools or props in creative, unexpected ways. The goal is to make the task fun, magical, and captivating to watch on a tiny scale.\n\nYou will be provided the list of processes in this format:  \n**Use a process from the following list: [list of processes...]**\n\n---\n\n**Output result as JSON:**\n\n\n{\n  \"Process ID\": \"id from the process list\",\n  \"process\": \"randomly chosen process from list\",\n  \"steps\": [\n    {\n      \"number\": 1,\n      \"rawDescription\": \"\"\n    },\n    {\n      \"number\": 2,\n      \"rawDescription\": \"\"\n    }\n    // Continue to 6–8 steps\n  ]\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[740,2840],"id":"c8927536-5471-45d0-a3c5-695ff77922ef","name":"Process Picker/Generator"},{"parameters":{"jsonSchemaExample":"{\n  \"Music_prompts\": [\n    \"Orchestral, playful pizzicato strings, light percussion, bouncing rhythm\",\n    \"Orchestral classical, staccato violins, playful xylophone, upbeat tempo\",\n    \"Classical, ethereal harp, delicate strings, lilting woodwinds, morning atmosphere\",\n    \"... (7 more prompts) ...\"\n  ]\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[3400,4580],"id":"67f34a9c-fd54-4582-9d82-365464dd4315","name":"Structured Output Parser5"},{"parameters":{"model":"openai/gpt-4.1-mini","options":{"temperature":0.6}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[3120,4580],"id":"5ced8873-fc75-4eee-ac28-3d57de85cc95","name":"OpenRouter Chat Model5"},{"parameters":{"promptType":"define","text":"=go","hasOutputParser":true,"options":{"systemMessage":"=You are an AI music generation assistant designed to support the creation of background music for short TikTok videos featuring tiny workers performing miniature tasks such as cooking, cleaning, and crafting. Your task is to generate **10 unique music prompts** using only **music-related language**.\n\nEach prompt must:\n\n* Be suitable for whimsical, creative, or slightly childish video themes.\n* Use dynamic, expressive musical descriptors (e.g., instrument types, rhythms, moods).\n* Focus on styles like classical, orchestral, lighthearted, fun, or beautiful.\n* Avoid non-musical language, explanations, or context.\n* Be rich enough to guide an AI music generation tool.\n\nYour output should always follow this **JSON format**:\n\n{\n  \"Music_prompts\": [\n    \"Orchestral, playful pizzicato strings, light percussion, bouncing rhythm\",\n    \"Orchestral classical, staccato violins, playful xylophone, upbeat tempo\",\n    \"Classical, ethereal harp, delicate strings, lilting woodwinds, morning atmosphere\",\n    \"... (7 more prompts) ...\"\n  ]\n}\n\n\nGenerate only the JSON object—do not include any additional commentary or formatting outside the JSON.\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[3180,4400],"id":"992c395d-9f5f-4f20-9d3e-5baa6328c00e","name":"Generate Music Promps"},{"parameters":{"fieldToSplitOut":"output.Music_prompts","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[3580,4400],"id":"8bf17036-dff4-4d20-a092-d141e3a77d68","name":"Split Prompts"},{"parameters":{"operation":"create","databaseId":191,"tableId":737,"fieldsUi":{"fieldValues":[{"fieldId":7188,"fieldValue":"={{ $json['output.Music_prompts'] }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[3840,4400],"id":"c1b813c2-6706-486c-86ef-200ad72bcdb8","name":"Add New Music Prompt"},{"parameters":{"content":"## Music Prompt Generator (10 new)\n","height":440,"width":1320,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2960,4280],"id":"669d3037-9e6d-45e1-bd13-b3ed0936efd1","name":"Sticky Note11"},{"parameters":{"databaseId":191,"tableId":738,"returnAll":true,"additionalOptions":{}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[280,3320],"id":"f67dbe2a-78fe-4897-9842-7c19f003b16e","name":"Get SoundFX Library"},{"parameters":{"operation":"update","databaseId":191,"tableId":736,"rowId":"={{ $('Get Scenes2').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7208,"fieldValue":"={{ $json.output.id }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1760,3320],"id":"93222dee-d795-452b-ad6b-44333b5673f7","name":"Update Scene with SoudFX ID"},{"parameters":{"databaseId":191,"tableId":735,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7191,"operator":"contains","value":"Processing"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[300,4520],"id":"2f70948f-98c8-46a0-93e0-020bee7d9812","name":"Get Video4"},{"parameters":{"databaseId":191,"tableId":736,"returnAll":true,"additionalOptions":{"filters":{"fields":[{"field":7187,"value":"={{ $json.id }}"}]}}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[720,4520],"id":"0aa739dd-2d49-4c00-a692-99f1313497e8","name":"Get Scenes4"},{"parameters":{"method":"POST","url":"https://queue.fal.run/fal-ai/kling-video/v1.6/standard/image-to-video","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n     \"prompt\":{{ JSON.stringify($json['Animation Prompt']) }},\n     \"image_url\": \"{{ $json['External Image URL'] }}\",\n     \"duration\": \"5\",\n     \"aspect_ratio\": \"9:16\",\n     \"negative_prompt\": \"blur, distort, and low quality\",\n     \"cfg_scale\": 0.5\n}\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1180,4460],"id":"d792f20b-9758-4f60-afb3-1a38de8019be","name":"fal.ai - Send Video Request"},{"parameters":{"url":"={{ $json.status_url }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1620,4380],"id":"856b76d0-35c5-4f6d-b41a-ed2085ec3da5","name":"Check Progress Status"},{"parameters":{"url":"={{ $json.response_url }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2060,4460],"id":"623d298c-2358-41b8-9347-060af8bffaf2","name":"Get Download URL"},{"parameters":{"url":"={{ $json.video.url }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2280,4460],"id":"5bb3eb34-7d45-44f3-a584-b1b0a4392559","name":"Download Video"},{"parameters":{"operation":"update","databaseId":191,"tableId":736,"rowId":"={{ $('Loop Over Items1').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7195,"fieldValue":"={{ $json.name }}"},{"fieldId":7197,"fieldValue":"={{ $('Download Video').item.json.video.url }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[2720,4520],"id":"afd1f504-73c3-45fe-87fa-803df36553e0","name":"Update Scene"},{"parameters":{"url":"={{ $json.response[0].file_url }}","options":{"response":{"response":{"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1600,4760],"id":"64c8fafd-354f-43c9-b168-6d72ae032ece","name":"Download Clip"},{"parameters":{"method":"POST","url":"http://host.docker.internal:8080/v1/ffmpeg/compose","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"id\": \"audio-layering\",\n  \"inputs\": [\n    {\n      \"file_url\": \"{{ $('Loop Over Items3').item.json['Video Clip'][0].url }}\"\n    },\n    {\n      \"file_url\": \"{{ $json['SoundFX File'][0].url }}\"\n    }\n  ],\n  \"filters\": [\n    {\n      \"filter\": \"[1:a]volume=1[outa]\"\n    }\n  ],\n  \"outputs\": [\n    {\n      \"options\": [\n        {\n          \"option\": \"-map\",\n          \"argument\": \"0:v\"\n        },\n        {\n          \"option\": \"-map\",\n          \"argument\": \"[outa]\"\n        },\n        {\n          \"option\": \"-c:v\",\n          \"argument\": \"copy\"\n        },\n        {\n          \"option\": \"-c:a\",\n          \"argument\": \"aac\"\n        },\n        {\n          \"option\": \"-shortest\"\n        }\n      ]\n    }\n  ]\n}\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1380,4760],"id":"9e608b53-ef38-40c3-b616-b0cc9a04bf1e","name":"NCA Add SoundFX"},{"parameters":{"fieldToSplitOut":"[\"Miniature Scenes\"]","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[520,4160],"id":"5a89ba5e-0a52-457a-aca8-46a28a0fbcb0","name":"Split Out Scenes 1"},{"parameters":{"fieldToSplitOut":"['Miniature Scenes']","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[500,5160],"id":"369e8508-7929-47c0-998f-d11eb851fefc","name":"Split Out Scenes4"},{"parameters":{"fieldToSplitOut":"[\"Miniature Scenes\"]","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[500,4520],"id":"278a3f2f-8a6d-48e4-880d-cc59aa1c5d5a","name":"Split Out Scenes 2"},{"parameters":{"fieldToSplitOut":"['Miniature Scenes']","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[500,4840],"id":"30e866b2-5f08-41a3-9748-577afa75bb1d","name":"Split Out Scenes 3"},{"parameters":{"fieldToSplitOut":"[\"Miniature Scenes\"]","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[940,3320],"id":"a3d5b7c8-58ac-4b8e-9d7f-0e21e71ee00e","name":"Split Out Scenes1"},{"parameters":{"operation":"update","databaseId":191,"tableId":736,"rowId":"={{ $('Loop Over Items').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7194,"fieldValue":"={{ $json.name }}"},{"fieldId":7196,"fieldValue":"={{ $('Download Image').item.json.data.generated[0] }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[2500,4160],"id":"f9548425-8102-49dd-9466-e1aa22ecb90f","name":"Update Scene1"},{"parameters":{"operation":"update","databaseId":191,"tableId":736,"rowId":"={{ $('Loop Over Items3').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7201,"fieldValue":"={{ $json.name }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[2040,4840],"id":"43288143-385f-49f9-bb86-ac57cd04810f","name":"Update Scene2"},{"parameters":{"operation":"update","databaseId":191,"tableId":735,"rowId":"={{ $json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7199,"fieldValue":"={{ $json.response }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1600,5160],"id":"1ffd016e-5457-4d5b-8593-5a1cf9dd0350","name":"Update Video"},{"parameters":{"operation":"update","databaseId":191,"tableId":735,"rowId":"={{ $('Get Video').item.json.id }}","fieldsUi":{"fieldValues":[{"fieldId":7192,"fieldValue":"={{ $json.output.id }}"}]}},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1780,3660],"id":"17c0e72f-09a7-411a-b540-6a71aac99b22","name":"Update Video1"},{"parameters":{"operation":"get","databaseId":191,"tableId":738,"rowId":"={{ $json.SoundFX[0].id }}"},"type":"n8n-nodes-base.baserow","typeVersion":1,"position":[1160,4760],"id":"155c3ab5-5be5-4c2b-a780-40184ef32ff4","name":"Get SoundFX"}],"connections":{"When clicking ‘Test workflow’":{"main":[[{"node":"Get Process Ideas","type":"main","index":0},{"node":"Get SoundFX Library","type":"main","index":0},{"node":"Get Video","type":"main","index":0},{"node":"Get Style By ID","type":"main","index":0},{"node":"Get Video4","type":"main","index":0},{"node":"Get video1","type":"main","index":0},{"node":"Get video","type":"main","index":0},{"node":"Get Video1","type":"main","index":0},{"node":"Get Last video","type":"main","index":0}]]},"OpenRouter Chat Model1":{"ai_languageModel":[[{"node":"Process Picker/Generator","type":"ai_languageModel","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"Create Scenes","type":"ai_languageModel","index":0}]]},"Structured Output Parser2":{"ai_outputParser":[[{"node":"Create Scenes","type":"ai_outputParser","index":0}]]},"Create Scenes":{"main":[[{"node":"Mark Process Used","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Send Request","type":"main","index":0}]]},"Send Request":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Check Request":{"main":[[{"node":"Is Completed","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Check Request","type":"main","index":0}]]},"Is Completed":{"main":[[{"node":"Download Image","type":"main","index":0}],[{"node":"Wait","type":"main","index":0}]]},"Aggregate":{"main":[[{"node":"Generate","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Generate","type":"ai_outputParser","index":0}]]},"Split Out1":{"main":[[{"node":"Add New Processes","type":"main","index":0}]]},"OpenRouter Chat Model3":{"ai_languageModel":[[{"node":"Generate","type":"ai_languageModel","index":0}]]},"Edit Fields":{"main":[[{"node":"Aggregate1","type":"main","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"Process Picker/Generator","type":"ai_outputParser","index":0}]]},"Set Scenes":{"main":[[{"node":"Split Out Scenes","type":"main","index":0}]]},"Create Video Record":{"main":[[{"node":"Set Scenes","type":"main","index":0}]]},"Split Out Scenes":{"main":[[{"node":"Create Scene Records","type":"main","index":0}]]},"Get Music":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"Get Video":{"main":[[{"node":"Get Music","type":"main","index":0}]]},"Aggregate1":{"main":[[{"node":"Music Picker","type":"main","index":0}]]},"OpenRouter Chat Model4":{"ai_languageModel":[[{"node":"Music Picker","type":"ai_languageModel","index":0}]]},"Structured Output Parser3":{"ai_outputParser":[[{"node":"Music Picker","type":"ai_outputParser","index":0}]]},"Music Picker":{"main":[[{"node":"Update Video1","type":"main","index":0}]]},"Upload to baserow":{"main":[[{"node":"Update Scene1","type":"main","index":0}]]},"Download Image":{"main":[[{"node":"Upload to baserow","type":"main","index":0}]]},"Loop Over Items1":{"main":[[],[{"node":"fal.ai - Send Video Request","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Check Progress Status","type":"main","index":0}]]},"Is Completed1":{"main":[[{"node":"Get Download URL","type":"main","index":0}],[{"node":"Wait1","type":"main","index":0}]]},"Upload to baserow1":{"main":[[{"node":"Update Scene","type":"main","index":0}]]},"Combine Clips":{"main":[[{"node":"Update Video","type":"main","index":0}]]},"Video url to array":{"main":[[{"node":"Combine Clips","type":"main","index":0}]]},"Get video":{"main":[[{"node":"Split Out Scenes4","type":"main","index":0}]]},"Get Scenes":{"main":[[{"node":"Aggregate2","type":"main","index":0}]]},"Aggregate2":{"main":[[{"node":"Video url to array","type":"main","index":0}]]},"Add Music":{"main":[[{"node":"HTTP Request6","type":"main","index":0}]]},"Get Video1":{"main":[[{"node":"Get Music1","type":"main","index":0}]]},"Get Music1":{"main":[[{"node":"Add Music","type":"main","index":0}]]},"Get video1":{"main":[[{"node":"Split Out Scenes 3","type":"main","index":0}]]},"Get Scenes1":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Loop Over Items3":{"main":[[],[{"node":"Get SoundFX","type":"main","index":0}]]},"Upload to baserow3":{"main":[[{"node":"Update Scene2","type":"main","index":0}]]},"HTTP Request6":{"main":[[{"node":"Upload to baserow6","type":"main","index":0}]]},"Upload to baserow6":{"main":[[{"node":"Baserow17","type":"main","index":0}]]},"Get All Processes":{"main":[[{"node":"Aggregate","type":"main","index":0}]]},"Generate":{"main":[[{"node":"Split Out1","type":"main","index":0}]]},"Get Video2":{"main":[[{"node":"Split Out Scenes1","type":"main","index":0}]]},"Aggregate3":{"main":[[{"node":"Get Video2","type":"main","index":0}]]},"Get Scenes2":{"main":[[{"node":"SoundFX Picker","type":"main","index":0}]]},"OpenRouter Chat Model2":{"ai_languageModel":[[{"node":"SoundFX Picker","type":"ai_languageModel","index":0}]]},"Structured Output Parser4":{"ai_outputParser":[[{"node":"SoundFX Picker","type":"ai_outputParser","index":0}]]},"SoundFX Picker":{"main":[[{"node":"Update Scene with SoudFX ID","type":"main","index":0}]]},"Aggregate4":{"main":[[{"node":"Process Picker/Generator","type":"main","index":0}]]},"Get Process Ideas":{"main":[[{"node":"Aggregate4","type":"main","index":0}]]},"Mark Process Used":{"main":[[{"node":"Create Video Record","type":"main","index":0}]]},"Get Video3":{"main":[[{"node":"Split Out Scenes 1","type":"main","index":0}]]},"Get Scenes3":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Get Style By ID":{"main":[[{"node":"Download Image2","type":"main","index":0}]]},"Download Image2":{"main":[[{"node":"Convert to Base64 String","type":"main","index":0}]]},"Convert to Base64 String":{"main":[[{"node":"Get Video3","type":"main","index":0}]]},"OpenRouter Chat Model6":{"ai_languageModel":[[{"node":"Create titles & hashtags","type":"ai_languageModel","index":0}]]},"Structured Output Parser6":{"ai_outputParser":[[{"node":"Create titles & hashtags","type":"ai_outputParser","index":0}]]},"Create titles & hashtags":{"main":[[{"node":"Download video","type":"main","index":0}]]},"Download video":{"main":[[{"node":"YouTube","type":"main","index":0}]]},"Get Last video":{"main":[[{"node":"Create titles & hashtags","type":"main","index":0}]]},"Process Picker/Generator":{"main":[[{"node":"Create Scenes","type":"main","index":0}]]},"Structured Output Parser5":{"ai_outputParser":[[{"node":"Generate Music Promps","type":"ai_outputParser","index":0}]]},"OpenRouter Chat Model5":{"ai_languageModel":[[{"node":"Generate Music Promps","type":"ai_languageModel","index":0}]]},"Generate Music Promps":{"main":[[{"node":"Split Prompts","type":"main","index":0}]]},"Split Prompts":{"main":[[{"node":"Add New Music Prompt","type":"main","index":0}]]},"Get SoundFX Library":{"main":[[{"node":"Aggregate3","type":"main","index":0}]]},"Get Video4":{"main":[[{"node":"Split Out Scenes 2","type":"main","index":0}]]},"Get Scenes4":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"fal.ai - Send Video Request":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Check Progress Status":{"main":[[{"node":"Is Completed1","type":"main","index":0}]]},"Get Download URL":{"main":[[{"node":"Download Video","type":"main","index":0}]]},"Download Video":{"main":[[{"node":"Upload to baserow1","type":"main","index":0}]]},"Update Scene":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Download Clip":{"main":[[{"node":"Upload to baserow3","type":"main","index":0}]]},"NCA Add SoundFX":{"main":[[{"node":"Download Clip","type":"main","index":0}]]},"Split Out Scenes 1":{"main":[[{"node":"Get Scenes3","type":"main","index":0}]]},"Split Out Scenes4":{"main":[[{"node":"Get Scenes","type":"main","index":0}]]},"Split Out Scenes 2":{"main":[[{"node":"Get Scenes4","type":"main","index":0}]]},"Split Out Scenes 3":{"main":[[{"node":"Get Scenes1","type":"main","index":0}]]},"Split Out Scenes1":{"main":[[{"node":"Get Scenes2","type":"main","index":0}]]},"Update Scene1":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Update Scene2":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Get SoundFX":{"main":[[{"node":"NCA Add SoundFX","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"e2f63db6-472a-4032-ae7c-d5c82815d0f7","triggerCount":0,"tags":[]}